
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>PMA & EDC ê³„ì‚°ê¸°</title>
  <style>
    body { font-family: sans-serif; max-width: 600px; margin: auto; padding: 2rem; }
    label { font-weight: bold; display: block; margin-top: 1.5rem; }
    .inline { display: flex; gap: 0.5rem; align-items: center; }
    input[type="number"], input[type="date"] {
      padding: 0.5rem;
      font-size: 1rem;
    }
    .result { margin-top: 2rem; font-size: 1.2rem; }
    .copy-box { margin-top: 2rem; background: #f3f3f3; padding: 1rem; border-radius: 8px; cursor: pointer; white-space: pre-line; }
  </style>
</head>
<body>

  <h2>ğŸ‘¶ PMA (ìˆ˜ì • í›„ ì—°ë ¹) & EDC (ì¶œìƒì˜ˆì •ì¼) ê³„ì‚°ê¸°</h2>

  <label>ì¬íƒœì—°ë ¹:</label>
  <div class="inline">
    <input type="number" id="gaw" min="20" max="45" value="30" />
    +
    <input type="number" id="gawd" min="0" max="6" value="0" />
  </div>

  <label>ì¶œìƒì¼:</label>
  <input type="date" id="birthDate" />

  <label>ê¸°ì¤€ì¼ (Optional, ë¹„ì›Œë‘ë©´ ì˜¤ëŠ˜):</label>
  <input type="date" id="referenceDate" />

  <div class="result" id="result"></div>

  <div class="copy-box" id="summaryBox" onclick="copySummary()">
    ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ (í´ë¦­í•˜ë©´ ë³µì‚¬ë©ë‹ˆë‹¤)
  </div>

  <script>
    function formatDate(date) {
      const yyyy = date.getFullYear();
      const mm = String(date.getMonth() + 1).padStart(2, '0');
      const dd = String(date.getDate()).padStart(2, '0');
      return `${yyyy}-${mm}-${dd}`;
    }

    function calculatePMA() {
      const gaw = parseInt(document.getElementById('gaw').value);
      const gawd = parseInt(document.getElementById('gawd').value);
      const birthInput = document.getElementById('birthDate').value;
      const refInput = document.getElementById('referenceDate').value;
      const refDate = refInput ? new Date(refInput) : new Date();

      if (isNaN(gaw) || isNaN(gawd) || !birthInput) {
        document.getElementById('result').innerHTML = "";
        document.getElementById('summaryBox').innerText = "ì…ë ¥ì„ ì™„ë£Œí•´ì£¼ì„¸ìš”.";
        return;
      }

      const birthDate = new Date(birthInput);
      const diffTime = refDate - birthDate;

      if (isNaN(birthDate.getTime()) || diffTime < 0) {
        document.getElementById('result').innerHTML = "ê¸°ì¤€ì¼ì€ ì¶œìƒì¼ ì´í›„ì—¬ì•¼ í•©ë‹ˆë‹¤.";
        document.getElementById('summaryBox').innerText = "ê¸°ì¤€ì¼ ì˜¤ë¥˜";
        return;
      }

      const daysAfterBirth = Math.floor(diffTime / (1000 * 60 * 60 * 24));
      const totalDays = (gaw * 7 + gawd) + daysAfterBirth;
      const pmaWeeks = Math.floor(totalDays / 7);
      const pmaDays = totalDays % 7;

      const edc = new Date(birthDate.getTime());
      edc.setDate(edc.getDate() + (280 - (gaw * 7 + gawd)));

      const dobStr = formatDate(birthDate);
      const doaStr = formatDate(birthDate);
      const edcStr = formatDate(edc);

      const summaryText = `D.O.B: ${dobStr}
D.O.A: ${doaStr}
E.D.C: ${edcStr}`;

      document.getElementById('result').innerHTML = `
        ğŸ—“ ìƒí›„ ê²½ê³¼ì¼ìˆ˜: <b>${daysAfterBirth}</b>ì¼<br>
        ğŸ“ PMA: <b>${pmaWeeks}ì£¼ + ${pmaDays}ì¼</b><br>
        ğŸ“… EDC: <b>${edcStr}</b>
      `;

      document.getElementById('summaryBox').innerText = summaryText;
      document.getElementById('summaryBox').dataset.clipboard = summaryText;
    }

    function copySummary() {
      const text = document.getElementById('summaryBox').dataset.clipboard || "";
      navigator.clipboard.writeText(text).then(() => {
        alert("ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤:\n" + text);
      });
    }

    document.addEventListener("DOMContentLoaded", () => {
      const today = new Date().toISOString().split("T")[0];
      document.getElementById("birthDate").value = today;
      document.getElementById("referenceDate").value = today;

      const inputs = document.querySelectorAll("input");
      inputs.forEach(input => input.addEventListener("input", calculatePMA));

      calculatePMA();
    });
  </script>

</body>
</html>
